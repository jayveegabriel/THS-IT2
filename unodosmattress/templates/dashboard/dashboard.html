
<!-- {% block content %} -->

{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<title>UDM - Dashboard</title>
<link rel="icon" href="{% static 'img/UDM.png'%}"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">

<link href="{% static 'css/bootstrap.min.css'%}" rel="stylesheet">
<link href="{% static 'css/bootstrap-responsive.min.css'%}" rel="stylesheet">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,600"
        rel="stylesheet">
<link href="{% static 'css/font-awesome.css'%}" rel="stylesheet">
<link href="{% static 'css/style.css'%}" rel="stylesheet">
<link href="{% static 'css/dashboard.css'%}" rel="stylesheet">
<link href="{% static 'css/data-tables.css'%}" rel="stylesheet">
<link href="{% static 'css/listbox.css'%}" rel="stylesheet">
<link href="{% static 'css/scrollbar.css'%}" rel="stylesheet">
<style>
  .chart {
    max-height:25px;
  }
	.badge1 {
	 position:relative;
	}
	.badge1[data-badge]:after {
	 content:attr(data-badge);
	 position:absolute;
	 top:-10px;
	 right:-10px;
	 font-size:.7em;
	 background:#b94a48;
	 color:white;
	 width:18px;height:18px;
	 text-align:center;
	 line-height:18px;
	 border-radius:50%;
	 box-shadow:0 0 1px #333;
	}

	.tabled td, tr {
	  border: .5px solid #eee;
	}
	.main {
	  top: 0;
	  padding: 16px;

	}
	.page-head {
	  z-index: 1;
	  border-bottom: 1px solid #eee;
	  background: #fff;
	  color: #000;
	  padding: 20px 0;
	  text-align: center;
	  width: 100%;
	  height: 50px;
	}
	.page-head.page-head-scrolled {
	  position: fixed;
	  top: 0;
	}
	.band {
	  padding: 60px 0 30px;
	}
	.wrap {
	  margin: 0 auto;
	  max-width: 1000px;
	}

	.sidenav {
	    height: 50%;
	    width: 0;
	    position: fixed;
	    z-index: 1;
	    top: 10px;
	    right: 0;
	    background-color: #111;
	    overflow-x: hidden;
	    transition: 0.5s;
	    padding-top: 60px;
	}
	.table-wrapper-scroll-y {
	display: block;
	max-height: 90%;
	overflow-y: auto;
	-ms-overflow-style: -ms-autohiding-scrollbar;
	}
	.sidenav a {
	    padding: 8px 8px 8px 32px;
	    text-decoration: none;
	    font-size: 25px;
	    color: #818181;
	    display: block;
	    transition: 0.3s;
	}

	.sidenav a:hover {
	    color: #f1f1f1;
	}

	.sidenav .closebtn {
	    position: absolute;
	    top: 0;
	    left: 25px;
	    font-size: 36px;
	    margin-right: 50px;
	}

	#mySidenav a {
	    opacity: 0.8;
	    z-index: 1;
	    position: fixed;
	    right: -175px;
	    transition: 0.3s;
	    padding: 20px;
	    width: 150px;
	    text-decoration: none;
	    font-size: 15px;
	    color: white;
	    height: 74%;
	    border-radius: 5px 5px 5px 5px;
	}

	#mySidenav a:hover {
	    right: 0;
	}


	#contact {

	    border: 1px solid #d6d6d6;
	    top: 104px;
	    color: #000;
	    background-color: #000;
	}

	.alert {
		width: 80%;
	}

	.containerwew{

		position: fixed;
		right: 5%;

	}
  .logoutbtn {
    border: none;
      background-color: inherit;
      font-size: 12px;
      padding-bottom: 3px;
      cursor: pointer;
      display: inline-block;
  }
  .success {color: green;}
  .info {color: dodgerblue;}
  .warning {color: orange;}
  .danger {color: red;}
  .default {color: white;}
  .badge1 {
   position:relative;
  }
  .form{display:flex; flex-direction:column; float:right;}

.checkbox-container{display:flex;}
.checkbox-container input[type="checkbox"]{display:inline-block;}
.checkbox-container label{display:inline;}
.switch {
  position: relative;
  display: inline-block;
  width: 54px;
  height: 25px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 20px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .slider {
  background-color: #2196F3;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}

/* Rounded sliders */
.slider.round {
  border-radius: 25px;
}

.slider.round:before {
  border-radius: 50%;
}
</style>

<body onload = "startTime()">
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"></span><span class="icon-bar"></span></span> </a><a class="brand" href="{% url 'unodosmattress:dashboard' %}"></a>
      <div class="nav-collapse">
        <ul class="nav pull-right">
          <button onclick="location.href='{% url 'unodosmattress:login' %}';" type ="submit"  class="logoutbtn default  dropdown-toggle"><i class="icon-signout"></i> Logout</button>

        </ul>
        <!--<form class="navbar-search pull-right">
          <input type="text" class="search-query" placeholder="Search">
        </form>!-->
      </div>
      <!--/.nav-collapse -->
    </div>
    <!-- /container -->
  </div>
  <!-- /navbar-inner -->
</div>
<!-- /navbar -->
<div class="subnavbar" >
  <div class="subnavbar-inner">
    <div class="container">
      <ul class="mainnav">
        <li class="active"><a href="{% url 'unodosmattress:dashboard' %}"><i class="icon-dashboard"></i><span>Dashboard</span> </a> </li>
        <li><a href="{% url 'unodosmattress:managepatients' %}"><i class="icon-user"></i><span>Manage Patients</span> </a> </li>
        <li class="dropdown" ><a href="javascript:;" id="dropdownLi"  class="dropdown-toggle" data-toggle="dropdown"> <i id="badgeData" class="icon-bell badge1" data-badge="{{newNotificationList }}"></i><span>Notifications</span><b class="caret"></b></a>
                  <ul class="dropdown-menu" style ="overflow-y: auto;width:300px;max-height: 200px;">
                    <li><table class="table table-bordered ">

                      <tbody id="notifBody">
                        {% for n in notifications %}
                        <tr>
                          <td style="width:30%;"><button class="btn btn-warning">Bed {{n.bedNumber}}</button></td>
                          <td style="width:70%; font-size:10px;">needs your assistance!</td>

                        </tr>
                        {% endfor %}
                      </tbody>
                    </table></li>
                    <a href="{% url 'unodosmattress:notifications' %}" style="text-align:center;"></i>View All</a>

                  </ul>
                </li>
      </ul>
    </div>
    <!-- /container -->
  </div>
  <!-- /subnavbar-inner -->
</div>

<div class="main">

    <h1 id="time" align ="center"></h1>

  <div id="mySidenav" class="sidenav">


    <a href="#" id="contact">Logs
      <button type="button" style="float:right" id="clearTable" class="btn btn-primary" >clear</button>
      <br><br>

        <div class="table-wrapper-scroll-y">
        <table class="table table-bordered ">

          <tbody id="logTable">
            <!-- <tr>
              <td style="width:20%;"><button class="btn btn-warning">1</button></td>
              <td style="width:80%; font-size:10px;">13:19:00 PM</td>

            </tr>
            <tr>
              <td style="width:20%;"><button class="btn btn-danger">1</button></td>
              <td style="width:80%; font-size:10px;">13:19:00 PM</td>

            </tr> -->

          </tbody>
        </table>


      </div>
    </a>


    </div>


  <div class="main-inner">
    <div class="container">

      <div class ="tabbable">
        <br>
                  <select class ="span2 roomDropdown">
                    <option disabled>Select Room No.</option>
                    {% for r in rooms %}
                      <option id="{{r.idRoom}}">{{r.roomNumber}}</option>
                    {% endfor %}

                  </select>
                  <div class ="form">
                  <div class="checkbox-container">
                     <label class ="switch"><input type="checkbox" id="checkboxAutoAdjust" style="float:right;" value="html-news" name="user-age"> <span class ="slider round"></span></label><label for="HTML news" style= "padding-top: 3px;padding-left:3px;"> Prioritization Feature</label>
                    </div>
                  </div>




        <ul class ="nav nav-tabs">
          <li class="active" style="width:50%;text-align:center">
                 <a href="#tileview" data-toggle="tab"><i class="icon-th-large"> </i><b> Tile View</b></a>
               </li>
               <li style="width:50%;text-align:center"><a href="#listview" data-toggle="tab"><i class =" icon-align-justify"></i><b> List View</b></a></li>
             </ul>
             <br>
       <div class ="tab-content">
         <div class="tab-pane active" id="tileview">
                 <div class="row" id="tileTable">

        {% for bed in default_room.get_occupied_beds_dashboard %}
          {% with bed.get_current_patient.idPatient as patient %}
               <div class = "span3">
                 <div class="widget " id = "{{patient.idPatient_id }}">
                 <div class="widget-header" > <i class="icon-user"></i>
                   <h3>Bed #{{ bed.bedNumber }}</h3>
                   <!-- <span class="badge badge-danger"></span> -->
                </div>
                <!-- /widget-header -->
                              <div class="widget-content" align = "center" id ="bed">
                                   <p><b>{{bed.get_current_patient.idPatient.lastName}}, {{bed.get_current_patient.idPatient.firstName}}</b></p>
                                  <!--  {% if patient.get_position == "RIGHT SIDE" %}
                                        <img src="{% static 'img/rightsidepos.png'%}"/ >
                                    {% endif %}
                                    {% if patient.get_position == "RIGHT FETAL" %}
                                        <img src="{% static 'img/rightfetalpos.png'%}"/ >
                                    {% endif %}
                                    {% if patient.get_position == "LEFT SIDE" %}
                                        <img src="{% static 'img/leftsidepos.png'%}"/ >
                                    {% endif %}
                                    {% if patient.get_position == "LEFT FETAL" %}
                                        <img src="{% static 'img/leftfetalpos.png'%}"/ >
                                    {% endif %}
                                    {% if patient.get_position == "BACK" %}
                                        <img src="{% static 'img/backpos.png'%}"/ >
                                    {% endif %}
                                    {% if patient.get_position == "NONE" %}
                                        <img src="{% static 'img/none.png'%}"/ >
                                    {% endif %}-->
                                    <div class ="widget-table action-table">
                                                    <table class=" widget-table table" >

                                                      <thead >
                                                        <tr>
                                                          <th  style="text-align:center; font-size:15px;">{{patient.get_position}}</th>

                                                        </tr>
                                                      </thead>
                                                      <tbody>
                                                      </tbody>
                                                    </table>
                                                    <table class="widget-table table" >

                                                      <thead >
                                                        <tr>
                                                          <th width="50%" style="text-align:center;font-size:15px">{{ patient.get_heartrate }} BPM</th>
                                                          <th width="50%"  style="text-align:center;font-size:15px">{{ patient.get_temperature }}˚C</th>

                                                        </tr>
                                                      </thead>
                                                      <tbody>
                                                      </tbody>
                                                  </table>
                                                  <table class="widget-table table" >

                                                    <thead >
                                                      <tr>
                                                        <th  width="25%"  style="text-align:center; font-size:10px;">{{ patient.minHeartRate }} BPM <br><span style="color:grey;"> MIN</span> </th>
                                                        <th  width="25%" style="text-align:center; font-size:10px;">{{ patient.maxHeartRate }} BPM <br><span style="color:grey;"> MAX </span></th>
                                                        <th  width="25%" style="text-align:center;  font-size:10px;">{{ patient.minTemp }}˚C <br><span style="color:grey;"> MIN </span></th>
                                                        <th  width="25%" style="text-align:center;  font-size:10px;">{{ patient.maxTemp }}˚C <br><span style="color:grey;"> MAX  </span></th>
                                                      </tr>
                                                    </thead>

                                                    <tbody>
                                                    </tbody>
                                                </table>

                                    </div>
                        </div>
        </div>

        </div>
        {% endwith %}
            {% endfor %}

            <div class = "span3">
              <div class="widget " id = "{{patient.idPatient_id }}">
              <div class="widget-header" > <i class="icon-user"></i>
                <h3>Bed #{{ bed.bedNumber }}</h3>
                <!-- <span class="badge badge-danger"></span> -->

             </div>
             <!-- /widget-header -->
             <div class="widget-content" align = "center" id ="bed">

                  <p><b>Domingo, Nicole</b></p>
                  <div id="chart1" style="height:100px;"></div>
                   <div class ="widget-table action-table">
                                   <table class=" widget-table table" >

                                     <thead >
                                       <tr>
                                         <th  style="text-align:center; font-size:15px;">NONE</th>

                                       </tr>
                                     </thead>
                                     <tbody>

                                     </tbody>
                                   </table>
                                   <table>
                                     <thead>
                                     <tr>
                                      <!-- <th id = "container"></th>-->
                                      </tr>
                                      </thead>
                                      <tbody>

                                      </tbody>
                                     </table>






                                 <table class="widget-table table" >

                                   <thead >
                                     <tr>
                                       <th  width="25%"  style="text-align:center; font-size:10px;">60 BPM <br><span style="color:grey;"> MIN</span> </th>
                                       <th  width="25%" style="text-align:center; font-size:10px;">120 BPM <br><span style="color:grey;"> MAX </span></th>
                                       <th  width="25%" style="text-align:center;  font-size:10px;">36˚C <br><span style="color:grey;"> MIN </span></th>
                                       <th  width="25%" style="text-align:center;  font-size:10px;">42˚C <br><span style="color:grey;"> MAX  </span></th>
                                     </tr>
                                   </thead>

                                   <tbody>
                                   </tbody>
                               </table>

                   </div>
       </div>
       </div>
       </div>

       <div class = "span3">
         <div class="widget " id = "{{patient.idPatient_id }}">
         <div class="widget-header" > <i class="icon-user"></i>
           <h3>Bed #{{ bed.bedNumber }}</h3>
           <!-- <span class="badge badge-danger"></span> -->

        </div>
        <!-- /widget-header -->
        <div class="widget-content" align = "center" id ="bed">

             <p><b>Domingo, Nicole</b></p>
             <div id="chart2" style="height:100px;"></div>
              <div class ="widget-table action-table">
                              <table class=" widget-table table" >

                                <thead >
                                  <tr>
                                    <th  style="text-align:center; font-size:15px;">NONE</th>

                                  </tr>
                                </thead>
                                <tbody>

                                </tbody>
                              </table>
                              <table>
                                <thead>
                                <tr>
                                 <!-- <th id = "container"></th>-->
                                 </tr>
                                 </thead>
                                 <tbody>

                                 </tbody>
                                </table>






                            <table class="widget-table table" >

                              <thead >
                                <tr>
                                  <th  width="25%"  style="text-align:center; font-size:10px;">60 BPM <br><span style="color:grey;"> MIN</span> </th>
                                  <th  width="25%" style="text-align:center; font-size:10px;">120 BPM <br><span style="color:grey;"> MAX </span></th>
                                  <th  width="25%" style="text-align:center;  font-size:10px;">36˚C <br><span style="color:grey;"> MIN </span></th>
                                  <th  width="25%" style="text-align:center;  font-size:10px;">42˚C <br><span style="color:grey;"> MAX  </span></th>
                                </tr>
                              </thead>

                              <tbody>
                              </tbody>
                          </table>

              </div>
  </div>
  </div>
  </div>




      <!-- /row -->
    </div>
    </div>

    <div class="tab-pane" id="listview">
                    <div class="widget-content">
                      <table class="table table-bordered" id="example">
                        <thead >
                          <tr>
                            <th style="text-align:center;"></th>
                            <th style="text-align:center;">Bed #</th>
                            <th style="text-align:center;">Name</th>
                            <th style="text-align:center;">Heart Rate</th>
                            <th style="text-align:center;">Temperature</th>
                            <th style="text-align:center;">Position</th>
                            <th style="text-align:center;">Status</th>

                          </tr>
                        </thead>
                        <tbody id="listTable">

                      {% for bed in default_room.get_occupied_beds_dashboard %}
                        {% with bed.get_current_patient.idPatient as patient %}

                          <tr style="border: 2px solid red;">
                            <td style="text-align:center;"><span class="badge badge-danger" style ="text-align:right;">3</span></td>
                            <td style="text-align:center;">{{bed.bedNumber}}</td>
                            <td style="text-align:center;">{{patient.lastName}}, {{patient.firstName}}</td>
                            <td style="text-align:center;color:red;">{{patient.get_heartrate}} BPM</td>
                            <td style="text-align:center;color:red;">{{patient.get_temperature}} ℃</td>
                            <td style="text-align:center;">{{patient.get_position}}</td>
                            <td style="text-align:center;">Normal</td>
                          </tr>


                        {% endwith %}
                       {% endfor %}



                        </tbody>
                      </table>
    					      </div> <!-- /widget-content -->
                  </div>
                </div>



              </div>




              <!-- /row -->
            </div>


            </div>


<!-- /main -->

<!-- /extra -->

<!-- /footer -->
<!-- Le javascript
================================================== -->
</body>
<script src="{% static 'js/jquery-1.7.2.min.js'%}"></script>
<script src="{% static 'js/excanvas.min.js'%}"></script>
<script src="{% static 'js/chart.min.js'%}" type="text/javascript"></script>
<script src="{% static 'js/bootstrap.js'%}"></script>
<script src="{% static 'js/highcharts.js'%}"></script>
<script src="{% static 'js/annotations.js'%}"></script>
<script src="{% static 'js/series-label.js'%}"></script>
<script src="{% static 'js/exporting.js'%}"></script>
<script src="{% static 'js/export-data.js'%}"></script>
<script language="javascript" type="text/javascript" src="{% static 'js/full-calendar/fullcalendar.min.js'%}"></script>

<audio id="myAudio">
	<source src="{% static 'sounds/notification.ogg' %}" type="audio/ogg">
	<source src="{% static 'sounds/notification.mp3' %}" type="audio/mpeg">
</audio>
<script src="{% static 'js/base.js'%}"></script>
<script>


Highcharts.chart(  "chart1" , {
  chart: {
    type: 'spline',
    animation: Highcharts.svg, // don't animate in old IE
    marginRight: 10,
    events: {
      load: function () {

        // set up the updating of the chart each second
        var series = this.series[0];
        setInterval(function () {
          var x = (new Date()).getTime(), // current time
            y = Math.random();
          series.addPoint([x, y], true, true);
        }, 1000);
      }
    }
  },

  time: {
    useUTC: false
  },

  title: {
    text: null
  },
  xAxis: {
    type: 'datetime',
    tickPixelInterval: 150
  },
  yAxis: {
    title: {
      text: null
    },
    plotLines: [{
      value: 0,
      width: 1,
      color: '#808080'
    }]
  },
  tooltip: {
    headerFormat: '<b>{series.name}</b><br/>',
    pointFormat: '{point.x:%Y-%m-%d %H:%M:%S}<br/>{point.y:.2f}'
  },
  legend: {
    enabled: false
  },
  exporting: {
    enabled: false
  },
  series: [{
    name: 'BPM',
    data: (function () {
      // generate an array of random data
      var data = [],
        time = (new Date()).getTime(),
        i;

      for (i = -19; i <= 0; i += 1) {
        data.push({
          x: time + i * 1000,
          y: Math.random()
        });
      }
      return data;
    }())
  }]
});
counter = counter + 1;
  function startTime() {
    var today = new Date();
    var h = today.getHours();
    var m = today.getMinutes();
    var s = today.getSeconds();
    var ampm = today.getHours();
    m = checkTime(m);
    ampm = check(ampm);
    s = checkTime(s);
    document.getElementById('time').innerHTML =
    h + ":" + m + ":" + s + " " + ampm;


    var t = setTimeout(startTime, 500);
  }
  function checkTime(i) {
    if (i < 10) {i = "0" + i};  // add zero in front of numbers < 10
    return i;
  }
  function check(i) {
    if (i < 12) {i = "AM"}
    else if (i >= 12) {i = "PM"};
    return i;
  }
  var rightSidePos = new Image();
  var rightFetalPos = new Image();
  var leftSidePos = new Image();
  var leftFetalPos = new Image();
  var backPos = new Image();
  var nonePos = new Image();

  function preload(){
    rightSidePos.src = "{% static 'img/rightsidepos.png'%}";
    rightFetalPos.src = "{% static 'img/rightfetalpos.png'%}";
    leftSidePos.src = "{% static 'img/leftsidepos.png'%}";
    leftFetalPos.src = "{% static 'img/leftfetalpos.png'%}";
    backPos.src ="{% static 'img/backpos.png'%}";
    nonePos.src = "{% static 'img/none.png'%}";
  }

  $(document).ready(function(){
    //preload();
    $(".roomDropdown").change(function(){
      var idRoom = this.value;
      updateDashboard(idRoom);



    });

    window.setInterval(function(){
      updateDashboard($(".roomDropdown").val());

    }, 1000);
  });

  function listMaker(bedNumber,lastName,firstName,heartRate,temperature, position,condition){

       if(condition == "critical"){
        wew = '<tr style="box-shadow:0px 0px 4px 2px red">';
       }
       else if(condition == "warning"){
        wew = '<tr style="box-shadow:0px 0px 4px 2px orange">';
       }
       else if(condition == "starting"){
        wew = '<tr style="box-shadow:0px 0px 4px 2px grey">';
       }
       else{
        wew = '<tr style="box-shadow:0px 0px 4px 2px">';
       }
       wew +='<td style="text-align:center;"><span class="badge badge-danger" style ="text-align:right;">3</span></td>'+
             '<td style="text-align:center;">' + bedNumber + '</td>'+
             '<td style="text-align:center;">' + lastName + ',' + firstName + '</td>' +
             '<td style="text-align:center;color:red;">' + heartRate + 'BPM</td>'+
             '<td style="text-align:center;color:red;">'+ temperature + '℃</td>'+
             '<td style="text-align:center;">'+ position +'</td>'+
             '<td style="text-align:center;">Normal</td></tr>';
      return wew;
 }
  function tileMaker(idPatient, bedNumber,firstName,lastName,position,heartRate,temperature,minHeartRate,maxHeartRate, minTemp,maxTemp,condition){
      waw = '<div class = "span3">';

      if(condition == "critical"){
        waw += '<div class="widget" style="box-shadow:0px 0px 10px 4px red" id = "'+ idPatient+'">';
      }
      else if(condition == "warning"){
        waw += '<div class="widget" style="box-shadow:0px 0px 10px 4px orange" id = "'+ idPatient+'">';
      }
      else if(condition == "starting"){

        waw += '<div class="widget" style="box-shadow:0px 0px 10px 4px grey" id = "'+ idPatient+'">';
      }
      else{

        waw += '<div class="widget" id = "'+ idPatient+'">';
      }
      waw += '<div class="widget-header"><i class="icon-user"></i><h3>Bed #'+bedNumber+'</h3>';
      waw += '</div><div class="widget-content" align = "center" id ="bed"><p>';
      waw += '<b>'+ lastName+', '+firstName+'</b></p>';

      if(position == "RIGHT SIDE"){
        image = rightSidePos;
      }
      if(position == "RIGHT FETAL"){
        image = rightFetalPos;
      }
      if(position == "LEFT SIDE"){
        image = leftSidePos;
      }
      if(position == "LEFT FETAL"){
        image = leftFetalPos ;
      }
      if(position == "BACK"){
        image = backPos;
      }
      if(position == "NONE"){
        image = nonePos;
      }

      waw += '<img src="'+image.src+'" />';
      // waw += image;
      waw += '<div class ="widget-table action-table"><table class=" widget-table table" >';
      waw += '<thead><tr><th style="text-align:center; font-size:15px;">' + position+'</th>';
      waw += '</tr></thead><tbody></tbody></table><table class="widget-table table"><thead><tr>';
      waw += '<th width="50%" style="text-align:center;font-size:15px">'+heartRate+' BPM</th>';
      waw += '<th width="50%"  style="text-align:center;font-size:15px">'+temperature+'˚C</th>';
      waw += '</tr></thead><tbody></tbody></table><table class="widget-table table"><thead ><tr>';
      waw += '<th  width="25%"  style="text-align:center; font-size:10px;">'+minHeartRate+ 'BPM <br><span style="color:grey;"> MIN</span></th>';
      waw += '<th  width="25%" style="text-align:center; font-size:10px;">'+maxHeartRate+' BPM <br><span style="color:grey;"> MAX </span></th>';
      waw += '<th  width="25%" style="text-align:center;  font-size:10px;">'+minTemp+'˚C <br><span style="color:grey;"> MIN </span></th>';
      waw += '<th  width="25%" style="text-align:center;  font-size:10px;">'+maxTemp+'˚C <br><span style="color:grey;"> MAX  </span></th>';
      waw += '</tr></thead><tbody></tbody></table></div></div></div></div>';
      return waw;

  }
  function patientobject(idPatient, toCompareHR, toCompareTEMP, status,firstName,lastName, heartRate,temperature,bedNumber, minTemp, maxTemp, minHeartRate, maxHeartRate, positionPatient){
    this.idPatient = idPatient;
    this.score = 0;
    this.toCompareHR = toCompareHR;
    this.toCompareTEMP = toCompareTEMP;
    this.status = status;
    this.firstName = firstName;
    this.lastName = lastName;
    this.heartRate = heartRate;
    this.temperature = temperature;
    this.bedNumber = bedNumber;
    this.minTemp = minTemp;
    this.maxTemp = maxTemp;
    this.minHeartRate = minHeartRate;
    this.maxHeartRate = maxHeartRate;
    this.positionPatient = positionPatient;
  }
  function updateDashboard(idRoom){


    $.ajax({
        url: '/ajax/ajaxGetUpdatedDashboard/',
        data: {
          "idRoom":idRoom,
        },
        dataType: 'json',
        success: function (data){
            var isChecked = $("#checkboxAutoAdjust").prop("checked");
            var tileTable = "";
            var listTable = "";

            if(!isChecked){
              data.patients.forEach(function(a){
                listTable += listMaker(a.bedNumber, a.lastName, a.firstName, a.heartRate, a.temperature, a.position,a.condition);
                tileTable += tileMaker(a.idPatient, a.bedNumber, a.firstName, a.lastName, a.position, a.heartRate, a.temperature, a.minhr,a.maxhr, a.mint,a.maxt,a.condition);
               });
            }

            else{
              var patientList = new Array();
              var patient = data.patients;
              data.patients.forEach(function(a){
                var p1 = new patientobject(a.idPatient, a.toCompareHR, a.toCompareTEMP, a.condition,a.firstName, a.lastName, a.heartRate, a.temperature, a.bedNumber, a.mint, a.maxt, a.minhr, a.maxhr, a.position);
                patientList.push(p1);
              });
                //arranges from lowest to highest
              for(var i = 0; i < patientList.length; i++){
                for(var j = 0; j < patientList.length - 1; j++){
                  if(patientList[i].toCompareHR < patientList[j].toCompareHR){
                    var temp = patientList[j];
                    patientList[j] = patientList[i];
                    patientList[i] = temp;
                  }
                }
              }
              //assigning if critical or warning
              for(var i=0; i < patientList.length; i++){
                if(patientList[i].toCompareHR < 0){
                  patientList[i].score = patientList[i].score + (patient.length - i)*2;
                }
                else{
                  patientList[i].score = patientList[i].score + patient.length - i;
                }
              }
               //arranges from lowest to highest
              for(var i = 0; i < patientList.length; i++){
                for(var j = 0; j < patientList.length - 1; j++){
                  if(patientList[i].toCompareTEMP < patientList[j].toCompareTEMP){
                    var temp = patientList[j];
                    patientList[j] = patientList[i];
                    patientList[i] = temp;
                  }
                }
              }
              //assigning if critical or warning
              for(var i=0; i < patientList.length; i++){
                if(patientList[i].toCompareTEMP < 0){
                  patientList[i].score = patientList[i].score + (patient.length - i)*2;
                }
                else{
                  patientList[i].score = patientList[i].score + patient.length - i;
                }
              }
              //sorting using the final score.
              for(var i = 0; i < patientList.length; i++){
                for(var j = 0; j < patientList.length - 1; j++){
                  if(patientList[i].score > patientList[j].score){
                    var temp = patientList[j];
                    patientList[j] = patientList[i];
                    patientList[i] = temp;
                  }
                }
              }
              patientList.forEach(function(a){
                if(a.status == "warning" || a.status == "critical"){
                  listTable += listMaker(a.bedNumber, a.lastName, a.firstName, a.heartRate, a.temperature, a.positionPatient,a.status);
                  tileTable += tileMaker(a.idPatient, a.bedNumber, a.firstName, a.lastName, a.positionPatient, a.heartRate, a.temperature, a.minHeartRate,a.maxHeartRate, a.minTemp,a.maxTemp,a.status);
                }

              });
              patientList.forEach(function(a){
                if(a.status == "normal" || a.status == "starting"){
                  listTable += listMaker(a.bedNumber, a.lastName, a.firstName, a.heartRate, a.temperature, a.positionPatient,a.status);
                  tileTable += tileMaker(a.idPatient, a.bedNumber, a.firstName, a.lastName, a.positionPatient, a.heartRate, a.temperature, a.minHeartRate,a.maxHeartRate, a.minTemp,a.maxTemp,a.status);
                }
              });

            }
            $("#tileTable").html(tileTable);
            $("#listTable").html(listTable);
        }
      });
  }
</script>

<!--
{% endblock content %} -->
